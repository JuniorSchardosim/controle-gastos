<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Controle de Gastos Mensais</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    
    <!-- Firebase -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getFirestore, collection, doc, setDoc, getDoc, onSnapshot } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';

        const firebaseConfig = {
            apiKey: "AIzaSyAiot3S4wOXuPSDOFsTv2UwizOKS9rxepY",
            authDomain: "controle-gastos-55f06.firebaseapp.com",
            projectId: "controle-gastos-55f06",
            storageBucket: "controle-gastos-55f06.firebasestorage.app",
            messagingSenderId: "20319528232",
            appId: "1:20319528232:web:056bb6e3a685e17abc1c1d"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        
        // Disponibilizar globalmente
        window.db = db;
        window.firestore = { collection, doc, setDoc, getDoc, onSnapshot };
    </script>
</head>
<body>
    <div class="tabs">
        <button class="tab-btn active" onclick="mudarAba('despesas')">üí∞ Despesas Mensais</button>
        <button class="tab-btn" onclick="mudarAba('vale')">üõí Vale Alimenta√ß√£o</button>
        <button class="tab-btn" onclick="mudarAba('supermercado')">üõçÔ∏è Lista de Compras</button>
        <button class="tab-btn" onclick="mudarAba('futuras')">üìÖ Compras Futuras</button>
    </div>

    <div class="container">
        <div id="aba-despesas" class="aba-conteudo active">
            <h1>üí∞ Controle de Gastos Mensais</h1>
            
            <div class="mes-atual">
                <h2 id="mes-atual-nome">Carregando...</h2>
                <button class="btn-fechar-mes" onclick="fecharMes()">Fechar M√™s e Salvar no Hist√≥rico</button>
            </div>

            <div class="salario-section">
                <label for="salario">Sal√°rio do M√™s:</label>
                <input type="number" id="salario" placeholder="R$ 0,00" step="0.01">
            </div>

            <div class="despesas-section">
                <h2>Adicionar Despesa</h2>
                <div class="despesa-form">
                    <input type="text" id="nome-despesa" placeholder="Nome da despesa">
                    <input type="number" id="valor-despesa" placeholder="R$ 0,00" step="0.01">
                    <input type="number" id="meses-despesa" placeholder="Quantos meses?" min="1">
                    <label class="checkbox-container">
                        <input type="checkbox" id="despesa-fixa">
                        <span>Despesa fixa</span>
                    </label>
                    <button class="btn-adicionar" onclick="adicionarDespesa()">Adicionar</button>
                </div>

                <div class="lista-despesas" id="lista-despesas">
                    <p class="vazio">Nenhuma despesa adicionada</p>
                </div>
            </div>

            <div class="resumo">
                <div class="resumo-item">
                    <span class="resumo-label">Sal√°rio:</span>
                    <span class="resumo-valor" id="resumo-salario">R$ 0,00</span>
                </div>
                <div class="resumo-item">
                    <span class="resumo-label">Total de Despesas:</span>
                    <span class="resumo-valor" id="resumo-despesas">R$ 0,00</span>
                </div>
                <div class="resumo-item">
                    <span class="resumo-label">Saldo:</span>
                    <span class="resumo-valor" id="resumo-saldo">R$ 0,00</span>
                </div>
            </div>

            <div class="historico-section">
                <h2>üìä Hist√≥rico de Meses Anteriores</h2>
                <div class="historico-lista" id="historico-lista">
                    <p class="vazio">Nenhum m√™s fechado ainda</p>
                </div>
            </div>
            
            <!-- Navega√ß√£o de M√™s Despesas -->
            <div class="navegacao-mes">
                <button class="btn-nav-mes" onclick="voltarMes()">‚óÄ Anterior</button>
                <button class="btn-nav-mes" onclick="avancarMes()">Seguinte ‚ñ∂</button>
            </div>
        </div>

        <!-- ABA VALE ALIMENTA√á√ÉO -->
        <div id="aba-vale" class="aba-conteudo">
            <h1>üõí Controle de Vale Alimenta√ß√£o</h1>

            <div class="mes-atual">
                <h2 id="vale-mes-atual">Carregando...</h2>
                <button class="btn-fechar-mes" onclick="fecharMesVale()">Fechar M√™s do Vale e Salvar no Hist√≥rico</button>
            </div>

            <div class="vale-saldo-section">
                <div class="vale-input-group">
                    <label for="vale-recarga">Valor Recarregado:</label>
                    <input type="number" id="vale-recarga" placeholder="R$ 0,00" step="0.01">
                    <button class="btn-adicionar" onclick="adicionarRecarga()">Adicionar Recarga</button>
                </div>
            </div>

            <div class="despesas-section">
                <h2>Adicionar Compra no Supermercado</h2>
                <div class="despesa-form">
                    <input type="text" id="nome-compra" placeholder="Nome do supermercado">
                    <input type="number" id="valor-compra" placeholder="R$ 0,00" step="0.01">
                    <input type="date" id="data-compra">
                    <button class="btn-adicionar" onclick="adicionarCompra()">Adicionar</button>
                </div>

                <div class="lista-despesas" id="lista-compras">
                    <p class="vazio">Nenhuma compra adicionada</p>
                </div>
            </div>

            <div class="resumo">
                <div class="resumo-item">
                    <span class="resumo-label">Total Recarregado:</span>
                    <span class="resumo-valor" id="vale-total-recarga">R$ 0,00</span>
                </div>
                <div class="resumo-item">
                    <span class="resumo-label">Total Gasto:</span>
                    <span class="resumo-valor" id="vale-total-gasto">R$ 0,00</span>
                </div>
                <div class="resumo-item">
                    <span class="resumo-label">Saldo Vale:</span>
                    <span class="resumo-valor" id="vale-saldo">R$ 0,00</span>
                </div>
            </div>

            <div class="historico-section">
                <h2>üìä Hist√≥rico de Vale Alimenta√ß√£o</h2>
                <div class="historico-lista" id="vale-historico-lista">
                    <p class="vazio">Nenhum hist√≥rico ainda</p>
                </div>
            </div>
            
            <!-- Navega√ß√£o de M√™s Vale -->
            <div class="navegacao-mes">
                <button class="btn-nav-mes" onclick="voltarMesVale()">‚óÄ Anterior</button>
                <button class="btn-nav-mes" onclick="avancarMesVale()">Seguinte ‚ñ∂</button>
            </div>
        </div>

        <!-- ABA LISTA DE COMPRAS SUPERMERCADO -->
        <div id="aba-supermercado" class="aba-conteudo">
            <h1>üõçÔ∏è Lista de Compras do Supermercado</h1>

            <div class="mes-atual">
                <h2>Organize suas compras</h2>
            </div>

            <div class="despesas-section">
                <h2>Adicionar Item √† Lista</h2>
                <div class="despesa-form">
                    <input type="text" id="nome-item-compra" placeholder="Nome do produto">
                    <input type="number" id="quantidade-item" placeholder="Quantidade" min="1" step="0.1">
                    <select id="categoria-item">
                        <option value="alimentos">Alimentos</option>
                        <option value="bebidas">Bebidas</option>
                        <option value="higiene">Higiene e Limpeza</option>
                        <option value="congelados">Congelados</option>
                        <option value="preco">Se estiver um bom pre√ßo compra</option>
                        <option value="outros">Outros</option>
                    </select>
                    <button class="btn-adicionar" onclick="adicionarItemCompra()">Adicionar</button>
                </div>

                <div class="lista-compras-container">
                    <div class="lista-compras-header">
                        <span class="header-item">Produto</span>
                        <span class="header-qtd">Qtd</span>
                        <span class="header-acao">A√ß√£o</span>
                    </div>
                    <div class="lista-compras" id="lista-compras-supermercado">
                        <p class="vazio">Nenhum item adicionado</p>
                    </div>
                </div>

                <div class="resumo-compras">
                    <div class="resumo-item">
                        <span class="resumo-label">Total de Itens:</span>
                        <span class="resumo-valor" id="total-itens">0</span>
                    </div>
                    <div class="resumo-item">
                        <span class="resumo-label">Itens Coletados:</span>
                        <span class="resumo-valor" id="itens-coletados">0</span>
                    </div>
                    <div class="resumo-item">
                        <span class="resumo-label">Progresso:</span>
                        <span class="resumo-valor" id="progresso-compras">0%</span>
                    </div>
                </div>

                <div class="barra-progresso">
                    <div class="barra-progresso-preenchida" id="barra-progresso"></div>
                </div>

                <div style="display: flex; gap: 10px; margin-top: 20px; justify-content: center;">
                    <button class="btn-limpar-lista" onclick="limparListaCompras()">üóëÔ∏è Limpar Lista</button>
                    <button class="btn-resetar-checks" onclick="resetarChecksCompras()">‚Üª Resetar Marca√ß√µes</button>
                </div>

                <div style="margin-top: 40px; border-top: 2px solid var(--border); padding-top: 30px;">
                    <h2>üìã Itens Pendentes (Comprar em Outro Lugar)</h2>
                    <div class="lista-compras-container">
                        <div class="lista-compras-header">
                            <span class="header-item">Produto</span>
                            <span class="header-qtd">Qtd</span>
                            <span class="header-acao">A√ß√£o</span>
                        </div>
                        <div class="lista-compras" id="lista-pendentes-supermercado">
                            <p class="vazio">Nenhum item pendente</p>
                        </div>
                    </div>
                    <div style="display: flex; gap: 10px; margin-top: 15px; justify-content: center;">
                        <button class="btn-limpar-lista" onclick="limparListaPendentes()">üóëÔ∏è Limpar Pendentes</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ABA COMPRAS FUTURAS -->
        <div id="aba-futuras" class="aba-conteudo">
            <h1>üìÖ Compras Futuras Planejadas</h1>

            <div class="mes-atual">
                <h2>Planejar as pr√≥ximas compras</h2>
            </div>

            <div class="despesas-section">
                <h2>Adicionar Compra Futura</h2>
                <div class="despesa-form">
                    <input type="text" id="nome-futura" placeholder="Nome do item/servi√ßo">
                    <input type="number" id="valor-futura" placeholder="R$ 0,00" step="0.01">
                    <input type="date" id="data-futura">
                    <select id="prioridade-futura">
                        <option value="baixa">Prioridade Baixa</option>
                        <option value="media">Prioridade M√©dia</option>
                        <option value="alta">Prioridade Alta</option>
                    </select>
                    <button class="btn-adicionar" onclick="adicionarCompraFutura()">Adicionar</button>
                </div>

                <div class="lista-despesas" id="lista-futuras">
                    <p class="vazio">Nenhuma compra futura planejada</p>
                </div>
            </div>

            <div class="resumo">
                <div class="resumo-item">
                    <span class="resumo-label">Total Planejado:</span>
                    <span class="resumo-valor" id="total-futuras">R$ 0,00</span>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
